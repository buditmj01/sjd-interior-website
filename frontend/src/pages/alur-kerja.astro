---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/common/Header.astro';
import Footer from '../components/common/Footer.astro';
import CTASection from '../components/common/CTASection.astro';
import FAQSection from '../components/common/FAQSection.astro';
import InsightCard from '../components/common/InsightCard.astro';
import { getInsights, getImageUrl, getWorkflowHero, getStrapiMedia } from '../lib/strapi';
import { sanitize } from '../lib/sanitize.js';

const steps = [
  {
    label: "MULAI DARI SINI",
    title: "Konsultasi",
    description: "Ceritakan kebutuhan dan impian ruang Anda. Tim kami akan menganalisis gaya hidup, preferensi, dan budget Anda secara mendetail.",
    image: "/images/workflow-consult.jpg",
    position: "left"
  },
  {
    label: "KUNJUNGAN",
    title: "Survei Lokasi",
    description: "Desainer kami akan mengunjungi lokasi untuk mengukur ruangan, memahami pencahayaan alami, dan menemukan potensi tersembunyi dari ruang Anda.",
    image: "/images/workflow-survey.jpg",
    position: "right"
  },
  {
    label: "PERENCANAAN",
    title: "Design & Anggaran",
    description: "Desain disusun berdasarkan referensi dan kebutuhan Anda, lengkap dengan perhitungan RAB yang terukur. Setelah disetujui, proses dilanjutkan dengan persetujuan RAB sebagai dasar pelaksanaan proyek.",
    image: "/images/workflow-planning.jpg",
    position: "left"
  },
  {
    label: "DESAIN",
    title: "Presentasi Konsep",
    description: "Kami sajikan konsep desain lengkap dengan moodboard, 3D rendering dan gambar teknis arsitektur.",
    milestoneAfter: "Penerimaan & TTD RAB dengan <b>DP 50%</b>",
    image: "/images/workflow-design.png",
    position: "right"
  },
  {
    label: "PERSIAPAN",
    title: "Pengadaan Material",
    description: "Seluruh furniture dikerjakan di workshop kami hingga selesai, kemudian dikirim ke lokasi setelah proses pembayaran tahap selanjutnya.",
    milestoneAfter: "<b>Termin 25%:</b> Dibayarkan saat produksi selesai dan siap kirim",
    image: "/images/workflow-materials.jpg",
    position: "left"
  },
  {
    label: "EKSEKUSI",
    title: "Pengerjaan di Lokasi",
    description: "Tim kami melakukan instalasi dan pengerjaan langsung di lokasi sesuai desain yang telah disepakati. Setiap proses dijalankan dengan rapi, terukur, dan diawasi hingga hasil akhir sesuai ekspektasi Anda.",
    image: "/images/workflow-execution.jpg",
    position: "right"
  },
  {
    label: "FINALISASI",
    title: "Serah terima & pembayaran",
    description: "Tahap akhir penyelesaian proyek dilakukan melalui proses pengecekan bersama untuk memastikan seluruh pekerjaan sesuai desain dan standar kualitas. Setelah progress 100% dan pembayaran final dilakukan serah terima.",
    image: "/images/process-handover.jpg",
    position: "left"
  }
];

// Format date to Indonesian (same as insight page)
const formatDate = (dateString: string) => {
  const date = new Date(dateString);
  return date.toLocaleDateString('id-ID', {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
  });
};

// Fetch workflow hero data from Strapi
const workflowHeroData = await getWorkflowHero();

// Extract hero content with fallback to defaults
const heroContent = {
  headline: workflowHeroData?.attributes?.headline || 'Prosesnya mudah.',
  subheadline: workflowHeroData?.attributes?.subheadline || 'Kami tangani semuanya dengan profesional. Anda tinggal nikmati hasilnya.',
  badgeText: workflowHeroData?.attributes?.badge_text || 'Secepat 2-8 minggu pengerjaan',
  videoUrl: workflowHeroData?.attributes?.video?.data?.attributes?.url
    ? getStrapiMedia(workflowHeroData.attributes.video.data.attributes.url)
    : '/videos/workflow-process.mp4',
  posterUrl: workflowHeroData?.attributes?.poster_image?.data?.attributes?.url
    ? getStrapiMedia(workflowHeroData.attributes.poster_image.data.attributes.url)
    : '/images/hero-background.jpg'
};

// Fetch latest insights from Strapi (limit 4 for alur-kerja)
const insightsResponse = await getInsights({ 'pagination[limit]': 4 });

// Transform insights data using the same approach as insight page
const insights = insightsResponse?.data?.map((insight: any) => ({
  title: insight.attributes.title,
  author: insight.attributes.author?.data?.attributes?.name || 'SJD Interior Team',
  authorPhoto: getImageUrl(insight.attributes.author?.data?.attributes?.photo, 'thumbnail'),
  date: formatDate(insight.attributes.publishedAt || insight.attributes.createdAt),
  category: insight.attributes.category.toUpperCase(),
  image: getImageUrl(insight.attributes.featured_image, 'medium') || '/images/insight-card.jpg',
  slug: insight.attributes.slug,
  featured: insight.attributes.is_featured || false
})) || [];
---

<BaseLayout
  title="Alur Kerja - SJD Interior"
  description="Proses mudah dan profesional untuk mewujudkan interior impian Anda bersama SJD Interior"
  jsonLd={{
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "Proses Desain Interior SJD Interior",
    "description": "Proses mudah dan profesional untuk mewujudkan interior impian Anda. Secepat 2-8 minggu pengerjaan.",
    "step": steps.map((step, i) => ({
      "@type": "HowToStep",
      "position": i + 1,
      "name": step.title,
      "text": step.description,
      "image": `https://sjdinterior.com${step.image}`
    }))
  }}
>
  <Header />

  <main class="bg-white">
    <!-- Hero Section - Split Layout with Video Player -->
    <section class="relative pt-32 pb-10 md:pt-44 md:pb-20 lg:pt-48 lg:pb-24 bg-white overflow-hidden">
      <div class="w-full max-w-[1761px] mx-auto px-6 md:px-12 lg:px-[151px]">

        <!-- Grid Layout: Text Left, Video Right -->
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-12 gap-6 md:gap-10 lg:gap-12 xl:gap-16 items-center">

          <!-- Left: Text Content -->
          <div class="xl:col-span-5 text-center lg:text-left z-10">
            <!-- Main Heading -->
            <h1 class="text-[clamp(40px,7vw,128px)] font-light text-black mb-3 md:mb-7 lg:mb-8 leading-[0.95] tracking-[-0.02em]">
              {heroContent.headline}
            </h1>

            <!-- Description -->
            <p class="text-[15px] md:text-[20px] lg:text-[28px] font-light text-[#666] leading-[1.4] max-w-xl mx-auto lg:mx-0 mb-5 md:mb-8 lg:mb-10">
              {heroContent.subheadline}
            </p>

            <!-- CTA Badge -->
            <div class="inline-flex items-center gap-2.5 px-4 py-2.5 md:px-5 md:py-3 bg-black/5 rounded-full border border-black/10 hover:bg-black/10 transition-colors">
              <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
              <span class="text-[13px] md:text-[15px] font-medium text-[#333]">{heroContent.badgeText}</span>
            </div>
          </div>

          <!-- Right: Video Player -->
          <div class="xl:col-span-7 relative">
            <div
              class="relative aspect-video w-full rounded-[20px] md:rounded-[40px] overflow-hidden shadow-[0_20px_60px_-15px_rgba(0,0,0,0.3)] group cursor-pointer"
              id="video-player"
            >
              <!-- Video Poster/Thumbnail -->
              <img
                src={heroContent.posterUrl}
                alt="Video Proses Interior"
                class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                id="video-poster"
              />

              <!-- Gradient Overlay -->
              <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent pointer-events-none"></div>

              <!-- Play Button -->
              <div class="absolute inset-0 flex items-center justify-center z-10 transition-all duration-300">
                <div class="relative group-hover:scale-110 transition-transform duration-300">
                  <!-- Outer Ring -->
                  <div class="absolute inset-0 bg-white/20 rounded-full scale-150 animate-pulse"></div>

                  <!-- Play Button Circle -->
                  <button
                    class="relative w-16 h-16 md:w-24 md:h-24 bg-white rounded-full flex items-center justify-center shadow-2xl transition-all duration-300 group-hover:bg-black focus:outline-none focus:ring-4 focus:ring-white/50"
                    aria-label="Play video"
                  >
                    <svg class="w-6 h-6 md:w-10 md:h-10 text-black transition-colors duration-300 group-hover:text-white ml-0.5 md:ml-1" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </button>
                </div>
              </div>

              <!-- Video Duration Badge -->
              <div class="absolute bottom-3 md:bottom-6 left-3 md:left-6 px-2.5 py-1 md:px-3 md:py-1.5 bg-black/80 backdrop-blur-md rounded-lg">
                <span class="text-white text-[11px] md:text-sm font-medium">2:30</span>
              </div>

              <!-- Hover Label -->
              <div class="absolute bottom-3 md:bottom-6 right-3 md:right-6 px-3 py-1.5 md:px-4 md:py-2 bg-white/95 backdrop-blur-md rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0">
                <span class="text-black text-[11px] md:text-sm font-medium whitespace-nowrap">Lihat Proses Kami</span>
              </div>

              <!-- Actual Video Element (Hidden by default) -->
              <video
                id="workflow-video"
                class="absolute inset-0 w-full h-full object-cover hidden"
                controls
                poster={heroContent.posterUrl}
              >
                <source src={heroContent.videoUrl} type="video/mp4">
                Your browser does not support the video tag.
              </video>
            </div>

            <!-- Decorative Elements -->
            <div class="hidden lg:block absolute -bottom-6 -right-6 w-48 h-48 bg-gradient-to-br from-black/5 to-transparent rounded-full blur-2xl -z-10"></div>
            <div class="hidden lg:block absolute -top-6 -left-6 w-32 h-32 bg-gradient-to-br from-black/5 to-transparent rounded-full blur-2xl -z-10"></div>
          </div>

        </div>
      </div>
    </section>

    <!-- Timeline Process -->
    <section class="relative py-10 md:py-20 lg:py-28 bg-white">
      <div class="w-full max-w-[1761px] mx-auto px-6 md:px-12 lg:px-[151px] relative">
        <!-- Section Title -->
        <div class="text-center mb-8 md:mb-12 lg:mb-16">
          <h2 class="text-[32px] md:text-[60px] lg:text-[80px] font-light text-black tracking-[-1.6px] md:tracking-[-3px] lg:tracking-[-4px]">Alur Pengerjaan</h2>
        </div>

        <!-- Steps -->
        {steps.map((step, index) => (
          <div class={`relative scroll-mt-20 mb-14 md:mb-48 lg:mb-64 last:mb-0 timeline-step-item`} id={`step-${index + 1}`}>
            <!-- Content - Text on one side, Image on opposite side -->
            {step.position === 'right' ? (
              <>
                {step.milestoneBefore && (
                  <div class="flex justify-center mb-6 md:mb-10 relative z-10">
                    <div class="w-auto min-w-[240px] md:min-w-[350px] lg:min-w-[420px] py-4 md:py-7 lg:py-8 px-5 md:px-8 lg:px-10 border border-black rounded-[16px] md:rounded-[25px] lg:rounded-[30px] bg-white">
                      <p class="text-[15px] md:text-[21px] lg:text-[24px] font-light text-black text-center leading-normal tracking-[-0.5px] md:tracking-[-1.05px]">
                        {step.milestoneBefore}
                      </p>
                    </div>
                  </div>
                )}
                <!-- Mobile: stacked full-width | Desktop: Text LEFT, Image RIGHT -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-5 md:gap-12 lg:gap-24 items-center relative">
                  <!-- Text -->
                  <div class="px-0 lg:px-12 text-left lg:text-right flex flex-col justify-center order-2 lg:order-1">
                    <div class="flex items-center gap-3 mb-2 md:mb-3 lg:justify-end">
                      <span class="flex items-center justify-center w-7 h-7 md:w-8 md:h-8 rounded-full bg-black text-white text-[12px] md:text-[13px] font-semibold lg:hidden">{index + 1}</span>
                      <p class="text-[12px] md:text-[15px] lg:text-[16px] font-bold text-[#929292] tracking-widest uppercase">
                        {step.label}
                      </p>
                    </div>
                    <h3 class="text-[24px] md:text-[40px] lg:text-[48px] font-light text-black mb-3 md:mb-5 leading-[1.1]">
                      {step.title}
                    </h3>
                    <p class="text-[14px] md:text-[18px] lg:text-[20px] font-normal text-[#666] leading-[1.6]">
                      {step.description}
                    </p>
                  </div>
                  <!-- Desktop dot -->
                  <div class="hidden lg:block absolute left-1/2 top-[60px] transform -translate-x-1/2 z-10 timeline-dot-container">
                    <div class="w-[16px] h-[16px] bg-[#D1D1D1] rounded-full ring-[20px] ring-white transition-all duration-300 timeline-dot"></div>
                  </div>
                  <!-- Image -->
                  <div class="px-0 lg:px-12 order-1 lg:order-2">
                    {step.image && (
                      <div class="overflow-hidden rounded-[16px] md:rounded-[20px]">
                        <img
                          src={step.image}
                          alt={step.title}
                          class="w-full h-auto aspect-[4/3] md:aspect-[628/418] object-cover"
                        />
                      </div>
                    )}
                  </div>
                </div>
                {step.milestoneAfter && (
                  <div class="flex justify-center mt-8 md:mt-24 lg:mt-32 relative z-10">
                    <div class="w-auto min-w-[240px] md:min-w-[350px] lg:min-w-[420px] py-4 md:py-7 lg:py-8 px-5 md:px-8 lg:px-10 border border-black rounded-[16px] md:rounded-[25px] lg:rounded-[30px] bg-white">
                      <p class="text-[15px] md:text-[21px] lg:text-[24px] font-light text-black text-center leading-normal tracking-[-0.5px] md:tracking-[-1.05px]" set:html={sanitize(step.milestoneAfter)}></p>
                    </div>
                  </div>
                )}
              </>
            ) : (
              <>
                {step.milestoneBefore && (
                  <div class="flex justify-center mb-6 md:mb-10 relative z-10">
                    <div class="w-auto min-w-[240px] md:min-w-[350px] lg:min-w-[420px] py-4 md:py-7 lg:py-8 px-5 md:px-8 lg:px-10 border border-black rounded-[16px] md:rounded-[25px] lg:rounded-[30px] bg-white">
                      <p class="text-[15px] md:text-[21px] lg:text-[24px] font-light text-black text-center leading-normal tracking-[-0.5px] md:tracking-[-1.05px]">
                        {step.milestoneBefore}
                      </p>
                    </div>
                  </div>
                )}
                <!-- Mobile: stacked full-width | Desktop: Image LEFT, Text RIGHT -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-5 md:gap-12 lg:gap-24 items-center relative">
                  <!-- Image -->
                  <div class="px-0 lg:px-12 flex justify-center lg:justify-end">
                    {step.image && (
                      <div class="overflow-hidden rounded-[16px] md:rounded-[20px]">
                        <img
                          src={step.image}
                          alt={step.title}
                          class="w-full h-auto aspect-[4/3] md:aspect-[628/418] object-cover"
                        />
                      </div>
                    )}
                  </div>
                  <!-- Desktop dot -->
                  <div class="hidden lg:block absolute left-1/2 top-[60px] transform -translate-x-1/2 z-10 timeline-dot-container">
                    <div class="w-[16px] h-[16px] bg-[#D1D1D1] rounded-full ring-[20px] ring-white transition-all duration-300 timeline-dot"></div>
                  </div>
                  <!-- Text -->
                  <div class="px-0 lg:px-12 text-left flex flex-col justify-center">
                    <div class="flex items-center gap-3 mb-2 md:mb-3">
                      <span class="flex items-center justify-center w-7 h-7 md:w-8 md:h-8 rounded-full bg-black text-white text-[12px] md:text-[13px] font-semibold lg:hidden">{index + 1}</span>
                      <p class="text-[12px] md:text-[15px] lg:text-[16px] font-bold text-[#929292] tracking-widest uppercase">
                        {step.label}
                      </p>
                    </div>
                    <h3 class="text-[24px] md:text-[40px] lg:text-[48px] font-light text-black mb-3 md:mb-5 leading-[1.1]">
                      {step.title}
                    </h3>
                    <p class="text-[14px] md:text-[18px] lg:text-[20px] font-normal text-[#666] leading-[1.6]">
                      {step.description}
                    </p>
                  </div>
                </div>
                {step.milestoneAfter && (
                  <div class="flex justify-center mt-8 md:mt-24 lg:mt-32 relative z-10">
                    <div class="w-auto min-w-[240px] md:min-w-[350px] lg:min-w-[420px] py-4 md:py-7 lg:py-8 px-5 md:px-8 lg:px-10 border border-black rounded-[16px] md:rounded-[25px] lg:rounded-[30px] bg-white">
                      <p class="text-[15px] md:text-[21px] lg:text-[24px] font-light text-black text-center leading-normal tracking-[-0.5px] md:tracking-[-1.05px]" set:html={sanitize(step.milestoneAfter)}></p>
                    </div>
                  </div>
                )}
              </>
            )}
          </div>
        ))}

        <!-- Center timeline line (desktop only) -->
        <div class="hidden lg:block absolute left-1/2 top-[228px] bottom-[80px] w-[2px] bg-[#F1F1F1] rounded-full transform -translate-x-1/2 z-0"></div>

        <!-- Progress Line (Animated, desktop only) -->
        <div class="hidden lg:block absolute left-1/2 top-[228px] bottom-[80px] w-[2px] bg-black rounded-full transform -translate-x-1/2 z-0 origin-top scale-y-0" id="progress-line"></div>

        <!-- Pengerjaan Selesai - End of Timeline -->
        <div class="flex justify-center mt-14 md:mt-44 lg:mt-56 relative z-10">
          <div class="w-auto min-w-[240px] md:min-w-[350px] lg:min-w-[420px] py-4 md:py-7 lg:py-8 px-5 md:px-8 lg:px-10 border border-black rounded-[16px] md:rounded-[25px] lg:rounded-[30px] bg-white">
            <p class="text-[15px] md:text-[21px] lg:text-[24px] font-light text-black text-center leading-normal tracking-[-0.5px] md:tracking-[-1.05px]">
              Pengerjaan selesai
            </p>
          </div>
        </div>

      </div>
    </section>

    <!-- Background Image Section for FAQ -->
    <section class="relative py-0 bg-white -mt-4 md:-mt-10">
      <div class="w-full h-[350px] md:h-[650px] lg:h-[800px] overflow-hidden relative">
        <img
          src="/images/hero-background.jpg"
          alt="Background"
          class="w-full h-full object-cover"
        />
        <div class="absolute inset-0 bg-gradient-to-b from-[rgba(0,0,0,0.5)] via-[rgba(0,0,0,0.3)] to-white"></div>
        <!-- Copywriting Overlay -->
        <div class="absolute inset-0 flex items-center justify-center">
          <div class="text-center max-w-[700px] md:max-w-[800px] lg:max-w-[900px] px-6 md:px-8">
            <h2 class="text-[36px] md:text-[64px] lg:text-[80px] font-light text-white leading-[1] tracking-[-1.8px] md:tracking-[-3.2px] lg:tracking-[-4px]">
              Wujudkan Interior<br/>Impian Anda
            </h2>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <div class="relative bg-white pt-0">
      <FAQSection />
    </div>

    <!-- Insights Section -->
    <section class="py-12 md:py-20 lg:py-28 bg-gradient-to-b from-white via-white to-[#f9f9f9]">
      <div class="w-full max-w-[1761px] mx-auto px-6 md:px-12 lg:px-[151px]">
        <div class="text-center mb-8 md:mb-12 lg:mb-16">
            <p class="text-[12px] md:text-[16px] lg:text-[18px] font-medium text-[#636363] uppercase tracking-wider mb-2 md:mb-3">Pelajari Lebih Lanjut</p>
          <h2 class="text-[32px] md:text-[60px] lg:text-[80px] font-light text-black mb-3 md:mb-4 tracking-[-1.6px] md:tracking-[-3px] lg:tracking-[-4px]">Insight & Tips<br />Desain Interior</h2>
          <p class="text-[14px] md:text-[18px] lg:text-[20px] text-[#636363] max-w-2xl mx-auto leading-[1.6]">Dapatkan inspirasi dan pengetahuan tentang tren desain terkini dari tim ahli kami.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-5 lg:gap-6 mb-8 md:mb-12 lg:mb-16">
          {insights.map((insight) => (
            <InsightCard {...insight} />
          ))}
        </div>

        <div class="text-center">
            <a
              href="/insight"
              class="inline-flex items-center justify-center px-6 md:px-10 py-2.5 md:py-4 text-[14px] md:text-[17px] lg:text-[18px] font-medium text-[#313131] bg-transparent border-2 md:border-[3px] border-[#313131] rounded-full hover:bg-[#313131] hover:text-white transition-all duration-300"
            >
              Jelajahi Semua Artikel
            </a>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <CTASection />
  </main>

  <Footer />

  <script>
    import { gsap, ScrollTrigger } from '../utils/gsap';

    document.addEventListener('astro:page-load', () => {
      // Parallax for Hero Image
      const heroImg = document.querySelector('[data-parallax-hero]');
      if (heroImg) {
        gsap.to(heroImg, {
          y: '15%',
          ease: "none",
          scrollTrigger: {
            trigger: heroImg.parentElement,
            start: "top bottom",
            end: "bottom top",
            scrub: true
          }
        });
      }
    });

    // Initial load fallback
    document.addEventListener('DOMContentLoaded', () => {
      const heroImg = document.querySelector('[data-parallax-hero]');
      if (heroImg) {
        gsap.to(heroImg, {
          y: '15%',
          ease: "none",
          scrollTrigger: {
            trigger: heroImg.parentElement,
            start: "top bottom",
            end: "bottom top",
            scrub: true
          }
        });
      }

      // Video Player Functionality
      const videoPlayer = document.getElementById('video-player');
      const video = document.getElementById('workflow-video');
      const poster = document.getElementById('video-poster');

      if (videoPlayer && video && poster) {
        videoPlayer.addEventListener('click', (e) => {
          // Don't trigger if clicking on video controls
          if (e.target.tagName === 'VIDEO') return;

          // Hide poster and play button overlays
          poster.style.display = 'none';
          const overlays = videoPlayer.querySelectorAll('.absolute:not(video)');
          overlays.forEach(overlay => {
            if (!overlay.classList.contains('hidden')) {
              overlay.style.display = 'none';
            }
          });

          // Show and play video
          video.classList.remove('hidden');
          video.play();
        });

        // Show poster again when video ends
        video.addEventListener('ended', () => {
          video.classList.add('hidden');
          poster.style.display = 'block';
          const overlays = videoPlayer.querySelectorAll('.absolute:not(video)');
          overlays.forEach(overlay => {
            overlay.style.display = '';
          });
        });
      }

      // --- Premium Timeline Animations ---
      // Progress Line Drawing
      const progressLine = document.getElementById('progress-line');
      const timelineSection = progressLine?.parentElement;

      if (progressLine && timelineSection) {
        gsap.to(progressLine, {
          scaleY: 1,
          ease: "none",
          scrollTrigger: {
            trigger: timelineSection,
            start: "top center",
            end: "bottom center",
            scrub: true
          }
        });
      }

      // Dot Activation & Content Entry
      const steps = document.querySelectorAll('.timeline-step-item');
      steps.forEach((step, i) => {
        const dot = step.querySelector('.timeline-dot');
        const content = step.querySelectorAll('.lg\\:px-12, .px-0');

        if (dot) {
          ScrollTrigger.create({
            trigger: step,
            start: "top center",
            end: "bottom center",
            onEnter: () => dot.classList.add('active-dot'),
            onLeaveBack: () => dot.classList.remove('active-dot'),
            onEnterBack: () => dot.classList.add('active-dot'),
            onLeave: () => dot.classList.remove('active-dot')
          });
        }

        // Entrance animation
        gsap.from(content, {
          y: 30,
          opacity: 0,
          duration: 1,
          stagger: 0.2,
          scrollTrigger: {
            trigger: step,
            start: "top 80%",
            toggleActions: "play none none reverse"
          }
        });
      });
    });
  </script>

  <style is:global>
    .active-dot {
      background-color: #000 !important;
      transform: scale(1.4);
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
  </style>
</BaseLayout>
