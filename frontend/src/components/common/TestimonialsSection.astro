---
// Testimonials Section - Carousel
const testimonials = [
  {
    text: "Kualitas premium, pengerjaan cepat, fast respon, harga bisa bisik-bisik, ownernya bisa maen drum. Pokonya mantullll bintang 5",
    author: "Trisna A.K",
    rating: 5
  },
  {
    text: "Hasil bagus memuaskan, team ramah, designnya bagus pokoknya memuaskan deh",
    author: "Cahyani Linda",
    rating: 5
  },
  {
    text: "Hasilnya sesuai dengam keinginan, kualitas bahannya juga ok, ga nyesel udah pake jasa desain interior nya, recommended banget",
    author: "Neneng Susanti",
    rating: 5
  },
  {
    text: "Recomended Aman, terpercaya.",
    author: "Didik Hermansyah",
    rating: 5
  }
];
---

<section class="py-16 md:py-20 lg:py-24 bg-white">
  <div class="w-full max-w-[1761px] mx-auto px-[151px]">
    <h2 class="text-[clamp(2rem,4.5vw,43.70px)] font-light text-[#151515] text-center mb-12 md:mb-16" style="letter-spacing: -2.18px;">
      Apa kata mereka tentang SJD Interior
    </h2>
    
    <!-- Carousel Container -->
    <div class="relative w-full">
      <!-- Testimonials Carousel -->
      <div class="overflow-hidden">
        <div id="testimonials-carousel" class="flex transition-transform duration-500 ease-out">
          {testimonials.map((testimonial, index) => (
            <div class="w-full flex-shrink-0">
              <div class="bg-white rounded-[22px] p-8 md:p-10 shadow-[0px_2.08px_19.45px_rgba(0,0,0,0.13)] min-h-[300px] flex flex-col justify-between">
                <!-- Quote Text -->
                <p class="text-[18px] md:text-[20px] font-light text-[#636363] leading-[28px] md:leading-[30px] mb-8">
                  "{testimonial.text}"
                </p>
                
                <!-- Author and Rating -->
                <div>
                  <p class="text-[18px] font-medium text-black mb-3">
                    {testimonial.author}
                  </p>
                  <div class="text-[16px] font-light text-[#ffc107]">
                    {"‚≠ê".repeat(testimonial.rating)}
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Navigation Buttons -->
      <button 
        id="prev-btn" 
        class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-16 md:-translate-x-20 w-12 h-12 md:w-14 md:h-14 rounded-full bg-white shadow-[0px_2.08px_19.45px_rgba(0,0,0,0.13)] flex items-center justify-center hover:bg-[#f5f5f5] transition-colors duration-200 active:scale-95"
        aria-label="Previous testimonial"
      >
        <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
      </button>

      <button 
        id="next-btn" 
        class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-16 md:translate-x-20 w-12 h-12 md:w-14 md:h-14 rounded-full bg-white shadow-[0px_2.08px_19.45px_rgba(0,0,0,0.13)] flex items-center justify-center hover:bg-[#f5f5f5] transition-colors duration-200 active:scale-95"
        aria-label="Next testimonial"
      >
        <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </button>

      <!-- Dots Indicator -->
      <div class="flex justify-center gap-2 mt-8 md:mt-10">
        {testimonials.map((_, index) => (
          <button
            class="dot w-2 h-2 rounded-full bg-[#d9d9d9] transition-all duration-300 cursor-pointer hover:bg-[#a0a0a0]"
            data-index={index}
            aria-label={`Go to testimonial ${index + 1}`}
          />
        ))}
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const carousel = document.getElementById('testimonials-carousel') as HTMLElement;
    const prevBtn = document.getElementById('prev-btn') as HTMLButtonElement;
    const nextBtn = document.getElementById('next-btn') as HTMLButtonElement;
    const dots = document.querySelectorAll('.dot');
    
    let currentIndex = 0;
    const totalItems = dots.length;
    let autoPlayInterval: number;

    const updateCarousel = () => {
      const offset = -currentIndex * 100;
      carousel.style.transform = `translateX(${offset}%)`;
      
      // Update dots
      dots.forEach((dot, index) => {
        if (index === currentIndex) {
          dot.classList.remove('bg-[#d9d9d9]');
          dot.classList.add('bg-black', 'w-3');
        } else {
          dot.classList.remove('bg-black', 'w-3');
          dot.classList.add('bg-[#d9d9d9]');
        }
      });
    };

    const goToSlide = (index: number) => {
      currentIndex = (index + totalItems) % totalItems;
      updateCarousel();
      resetAutoPlay();
    };

    const nextSlide = () => {
      goToSlide(currentIndex + 1);
    };

    const prevSlide = () => {
      goToSlide(currentIndex - 1);
    };

    const startAutoPlay = () => {
      autoPlayInterval = window.setInterval(nextSlide, 5000);
    };

    const resetAutoPlay = () => {
      clearInterval(autoPlayInterval);
      startAutoPlay();
    };

    prevBtn?.addEventListener('click', prevSlide);
    nextBtn?.addEventListener('click', nextSlide);

    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => goToSlide(index));
    });

    updateCarousel();
    startAutoPlay();

    // Pause autoplay on hover
    carousel.parentElement?.addEventListener('mouseenter', () => {
      clearInterval(autoPlayInterval);
    });

    carousel.parentElement?.addEventListener('mouseleave', () => {
      startAutoPlay();
    });
  });
</script>
