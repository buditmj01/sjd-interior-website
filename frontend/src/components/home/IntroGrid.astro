---
// Intro section with portfolio grid
const portfolioCards = [
  { image: '/images/portfolio-card-1.jpg' },
  { image: '/images/portfolio-card-1.jpg' },
  { image: '/images/portfolio-card-1.jpg' },
  { image: '/images/portfolio-card-1.jpg' },
];
---

<section class="relative py-16 md:py-24 bg-gradient-to-b from-white via-white to-[#fff7ee]" data-intro-section>
  <div class="container mx-auto max-w-[1440px] px-4 md:px-8">
    <!-- Heading -->
    <div class="mb-12 md:mb-16" data-intro-heading>
      <h2 class="text-[clamp(2.5rem,6vw,96px)] font-light leading-[1.2] mb-4" style="letter-spacing: -4.8px;" data-intro-line>
        <span class="text-black">SJD Interior </span>
        <span class="text-black">adalah</span>
      </h2>
      <h2 class="text-[clamp(2.5rem,6vw,96px)] font-light leading-[1.2]" style="letter-spacing: -4.8px;" data-intro-line>
        <span class="text-black">solusi desain lengkap</span>
      </h2>
      <h2 class="text-[clamp(2.5rem,6vw,96px)] font-light leading-[1.2]" style="letter-spacing: -4.8px;" data-intro-line>
        <span class="text-black">personal </span>
        <span class="text-black">dan tanpa</span>
      </h2>
      <h2 class="text-[clamp(2.5rem,6vw,96px)] font-light leading-[1.2]" style="letter-spacing: -4.8px;" data-intro-line>
        <span class="text-black">ribet.</span>
      </h2>
    </div>

    <!-- Portfolio Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12" data-intro-grid>
      {portfolioCards.map((card, index) => (
        <div class="group relative rounded-[17px] overflow-hidden aspect-[3/4] cursor-pointer" data-intro-card data-card-index={index}>
          <!-- Background Image -->
          <img 
            src={card.image} 
            alt="Portfolio showcase" 
            class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
            data-card-image
          />
          
          <!-- Gradient Overlay -->
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
          
          <!-- Text Content -->
          <div class="absolute bottom-0 left-0 right-0 p-6 text-white">
            <p class="text-[30.13px] font-light mb-2" style="letter-spacing: -1.51px;">
              Lihat hasil karya kami langsung.
            </p>
            <a 
              href="/portfolio" 
              class="inline-block text-[30.13px] font-normal hover:opacity-80 transition-opacity"
              style="letter-spacing: -1.51px;"
            >
              Jelajahi portfolio →
            </a>
          </div>
        </div>
      ))}
    </div>

    <!-- Description Text -->
    <div class="text-center max-w-4xl mx-auto space-y-4" data-intro-description>
      <p class="text-[clamp(1.5rem,3vw,36px)] font-light text-black leading-relaxed" style="letter-spacing: -1.8px;">
        Kami handle semuanya, dari desain sampai furniture.<br />
        Tersedia sekarang di seluruh Indonesia.
      </p>
      <a 
        href="/portfolio" 
        class="inline-block text-[20px] font-light text-black hover:opacity-70 transition-opacity"
      >
        Mau lihat hasil kerja kami? Jelajahi portfolio →
      </a>
    </div>
  </div>
</section>

<!-- IntroGrid Parallax Animations -->
<script>
  import { createReveal, createScaleAnimation, createParallax, gsap } from '../../utils/gsap';

  const initIntroAnimations = () => {
    const introSection = document.querySelector('[data-intro-section]');
    if (!introSection) return;

    // Reveal heading lines with stagger
    const introLines = document.querySelectorAll('[data-intro-line]');
    if (introLines.length > 0) {
      createReveal(Array.from(introLines) as HTMLElement[], {
        from: { opacity: 0, y: 80 },
        to: { opacity: 1, y: 0 },
        stagger: 0.15,
        start: 'top 75%',
        once: true,
      });
    }

    // Layered parallax on portfolio cards with depth
    const cards = document.querySelectorAll('[data-intro-card]');
    cards.forEach((card, index) => {
      const cardElement = card as HTMLElement;
      const image = card.querySelector('[data-card-image]');
      
      // Different parallax speeds for depth effect
      // Cards on the left move slower, cards on the right move faster
      const speeds = [0.3, 0.5, 0.7, 0.9]; // Layered depth
      const speed = speeds[index % speeds.length];

      // Card reveal animation with stagger
      gsap.fromTo(
        cardElement,
        {
          opacity: 0,
          y: 100,
          scale: 0.9,
        },
        {
          opacity: 1,
          y: 0,
          scale: 1,
          duration: 1,
          ease: 'power3.out',
          delay: index * 0.1 + 0.3,
          scrollTrigger: {
            trigger: cardElement,
            start: 'top 85%',
            once: true,
          },
        }
      );

      // Parallax movement on scroll
      if (image) {
        createParallax(image as HTMLElement, {
          speed: speed,
          direction: 'vertical',
          start: 'top bottom',
          end: 'bottom top',
        });
      }

      // Scale effect on images
      if (image) {
        createScaleAnimation(image as HTMLElement, {
          fromScale: 1.1,
          toScale: 1,
          start: 'top 80%',
          end: 'top 30%',
          scrub: 1,
        });
      }
    });

    // Reveal description with fade
    const description = document.querySelector('[data-intro-description]');
    if (description) {
      createReveal(description as HTMLElement, {
        from: { opacity: 0, y: 60 },
        to: { opacity: 1, y: 0 },
        start: 'top 80%',
        once: true,
      });
    }
  };

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', initIntroAnimations);
  
  // Re-initialize for Astro view transitions
  document.addEventListener('astro:page-load', initIntroAnimations);
</script>

<style>
  /* Performance optimization */
  [data-intro-card],
  [data-card-image] {
    will-change: transform, opacity;
  }

  @media (prefers-reduced-motion: reduce) {
    [data-intro-card],
    [data-card-image] {
      will-change: auto;
      transform: none !important;
    }
  }
</style>